# 理解与应用威胁建模的概念和方法
- 概念：威胁建模是识别、分类和分析潜在威胁的安全过程。威胁建模可当作设计和开发期间的一种主动措施被执行，也可作为产品部署后的一种被动措施被执行。这两种情况下，威胁建模过程都识别了潜在危害、发生的可能性、关注的优先级以及消除或减少威胁的手段。
威胁建模不是一个独立事件。组织通常在进行系统设计过程早期就开始进行威胁建模，并持续贯穿千系统整个生命周期中。例如，微软使用安全开发生命周期(SDL)过程在产品开发的每个阶段考虑和实现安全。这种做法支待“设计安全，默认安全，部署和通信安全”（也称为SD3+C) 的座右铭。换句话说，尽力减少脆弱性与降低任何现存脆弱性的影响。总体结果也就降低了风险。
- 主动式威胁建模：发生在系统开发的早期阶段，特别是在初始设计和规范建立阶段。这种类型的威胁建模也被称为防御方法。这种方法基于在编码和制作过程中预测威胁和设计特定防御，而不是依赖于部署后更新和打补丁。大多数情况下，集成的安全解决方案成本效益更高，比后期追加的解决方案更有效。遗憾的是，并非所有威胁都能在设计阶段被预测到，所以仍然需要被动式威胁建模来解决不可预见的问题。
- 被动式威胁建模：发生在产品创建与部署后。这种部署可在测试或实验室环境中进行，或在通用市场中进行。此类威胁建校也称为对抗性方法。这种威胁建模技术是道德黑客、渗透测试、源代码审查和模糊测试（向软件提供无效的输入）背后的核心概念。尽管这些过程在发现重要解决的缺陷和威胁方面通常很有用，但遗憾的是，它们导致需要在编码中添加新对策的工作。
---
## 识别威胁
- 关注资产：该方法以资产为中心，利用资产评估结果，试图识别对有价值资产的威胁。例如，可对特定资产进行评估，以确定它是否容易受到攻击。如果资产中承载数据，则可通过评估访问控制来识别能绕过身份验证或授权机制的威胁。
- 关注攻击者：有些组织能识别潜在攻击者，并能根据攻击者的目标识别代表的威胁。例如，政府通常能识别潜在的攻击者以及攻击者想要达到的目标。然后，可利用这些数据来识别和保护相关资产。这种方法面临的一个挑战是，可能会出现之前未视为威胁的新攻击者。
- 关注软件：如果组织开发了软件，就需要考虑针对软件的潜在威胁。
- 几种模型
### STRIDE
  - 欺骗(Spoofing) ： 通过使用伪造的身份获得对目标系统访问权限的攻击行为。欺骗可用于IP 地址、MAC 地址、用户名、系统名、无线网络服务集标识符(SSID)、电子邮件地址和其他许多类型的逻辑标识。
  - 篡改(Tampering) ： 对传输或存储中的数据进行任何未经授权的更改或操纵。篡改被用来伪造通信或改变静态信息。这种攻击破坏了完整性和可用性。
  - 否认(Repudiation)：用户或攻击者否认执行动作或活动的能力。通常，攻击者会否认攻击以保持合理的辩解，从而不对自己的行为负责。
  - 信息泄露(Information Disclosure)：将私有、机密或受控信息泄露或发送给外部或未经授权的实体。这些信息可能包括客户身份信息、财务信息或专有业务操作细节。
  - 拒绝服务(DoS)：该攻击试图阻止对资源的授权使用。这类攻击可通过利用缺陷、过载连接或爆发流量来进行。DoS 攻击不一定导致资源完全无法访问，而是会减低吞吐量或提高延迟，阻碍对资源的有效使用。有一些DoS 攻击带来的危害是长久性的。长久性DoS 攻击可能包括对数据集的破坏，用恶意软件替换原有软件，或劫持可能被中断的固件闪存操作或安装有问题的固件。要从永久性DoS 攻击中恢复，需要完整的系统修复和备份恢复。
  - 特权提升(Elevation of Privilege)：该攻击是将权限有限的用户账户转换为具有更大特权、权利和访问权限的账户。这类攻击可能通过窃取或利用高级账户的凭据来实现，例如管理员(administrator)或根用户(root) 。特权提升攻击也包括攻击系统或应用程序，使权限有限的其他账户临时或永久地获得额外权限。

### 攻击模拟和威胁分析(Process for Attack Simulation and Threat Analysis, PASTA)
  - 阶段1: 为风险分析定义目标
  - 阶段2: 定义技术范围(Definition of the Technical Scope, DTS)
  - 阶段3: 分解和分析应用程序(Application Decomposition and Analysis, ADA)
  - 阶段4: 威胁分析(Threat Analysis, TA)
  - 阶段5: 弱点和脆弱性分析(Weakness and Vulnerability Analysis, WVA)
  - 阶段6: 攻击建模与仿真(Attack Modeling & Simulation, AMS)
  - 阶段7: 风险分析和管理(Risk Analysis & Management, RAM)

### Trike
是另一种基于风险的威胁建模方法，侧重于基于风险，而不是依赖于STRIDE 和DREAD(Disaster, Reproducibility, Exploitability, Affected Users and Discoverability, 潜在破坏、可再现性、可利用性、受影响用户和可发现性）中使用的聚合威胁模型。Trike 提供了一种可靠的、可重复的安全审核方法。它还为安全工作人员之间的通信和协作提供了一致的框架。Trike 对每种资产的可接受风险水平进行评估，然后确定适当的风险响应行动。

### VAST(Visual, Agile, and Simple Threat, 视觉、敏捷和简单威胁）
是一种基于敏捷项目管理和编程原则的威胁建模概念。VAST 的目标是在可伸缩的基础上将威胁和风险管理集成到敏捷编程环境中。

---
## 确定和绘制潜在的攻击
一旦对开发项目或部署的基础设施面临的威胁有所了解，威胁建模的下一步就是确定可能发生的潜在攻击。这通常通过创建事务中的元素图表及数据流和权限边界来完成。这种数据流图通过可视化表示，有助于更好地理解资源和数据流动之间的关系。绘制图表的过程也称为绘制架构图。创建图表有助千详细描述业务任务、开发过程或工作活动中的每个元素的功能和目的。重要的是要包括用户、处理器、应用程序、数据存储以及执行特定任务或操作需要的其他所有基本元素。这是高层次的概述而不是对编码逻辑的详细评估。
- 执行简化分析：威胁建模的下一步是执行简化分析。简化分析也称为分解应用程序、系统或环境。这项任务的目的是更好地理解产品的逻辑及其与外部元素的交互。无论应用程序、系统或整个环境，都需要划分为更小的容器或单元。如果关注的是软件、计算机或操作系统，那么这些可能是子程序、模块或客体；如果关注的是系统或网络，这些可能是协议。如果关注的是整个业务基础结构，这些可能是部门、任务和网络。为理解输入、处理、信息安全、数据管理、存储和输出，应该对每个已识别的子元素进行评估。在分解过程中，必须确定五个关键概念：
  - 信任边界信任级别或安全级别发生变化的位置。
  - 数据流路径数据在两个位置之间的流动。
  - 输入点接收外部输入的位置。
  - 特权操作需要比标准用户账户或流程拥有更大特权的任何活动，通常需要修改系统或更改安全性。
  - 安全声明和方法的细节关于安全策略、安全基础和安全假设的声明。
- 优先级排序和响应：因为通过威胁建模过程识别出威胁，所以需要规定额外的活动来完成整个过程。下一步是全面记录这些威胁。在这个文档中，应该说明威胁的手段、目标和后果。要考虑完成开发所需的技术以及列出可能的控制措施和防护措施。编制文档后，要对威胁进行排序或定级。可使用多种技术来完成这个过程，如“概率X 潜在损失”排序、高／中／低评级或DREAD 系统。
  - 排序：DREAD 评级系统旨在提供一种灵活的评级解决方案，它基千对每个威胁的五个主要问题的回答。
    - 潜在破坏：如果威胁成真，可能造成的伤害有多严重？
    - 可再现性：攻击者复现攻击有多复杂？
    - 可利用性：实施攻击的难度有多大？
    - 受影响用户：有多少用户可能受到攻击的影响（按百分比）？
    - 可发现性：攻击者发现弱点有多难？
  - 响应：一旦确定了威胁优先级，就需要确定对这些威胁的响应。响应选项应该包括对软件体系结构进行调整、更改操作和流程以及实现防御性与探测性组件。

---
## 将基于风险的管理理念应用到供应链
将基于风险的管理理念应用到供应链是一种确保安全策略更加可靠与成功的手段，适合在所有规模的组织中运用。供应链的概念并非指单个实体，而是包括大多数计算机、设备、网络和系统。事实上，我们所知道的大多数电脑和设备制造公司一一如Dell 、Cisco 、ExtremeNetworks 、Juniper、Asus 、Acer 和Apple 一般都是按每台电脑的组装形式生产，而不是生产所有单个部件。通常CPU、内存、驱动控制器、硬盘驱动器、SSD 卡和显卡都由其他第三方供应商生产。即便是这些大型销售商，也不太可能自行开采金属、加工石油制成塑料或生产蚀刻芯片的硅。因此，任何已完成的系统都有一段漫长而复杂的历史，这也使得供应链得以存在。安全供应链指的是供应链中的所有供应商或链接都是可靠的、值得信赖的、信誉良好的组织，他们向业务伙伴（尽管不一定向公众）披露他们的实践和安全需求。供应链中的每个环节都是可靠的，并对下一个环节负责。在为安全集成而评估第三方时，请考虑以下过程：
- 现场评估 到组织现场进行访谈，并观察工作人员的操作习惯。
- 文件交换和审查 调查数据和文件记录交换的方式，以及执行评估和审查的正式过程。
- 过程策略审查 要求提供安全策略、过程／程序，以及事件和响应文件的副本以供审查。
- 第三方审计 根据美国注册会计师协会(AICPA)的定义，拥有独立的第三方审计机构可根据SOC 报告，对实体的安全基础设施进行公正的审查。认证业务标准声明(SSAE 18)是一项规定，定义了服务组织如何使用各种SOC 报告来报告合规性。为进行安全性评估，需要考虑SOC1 和SOC2 审计框架。SOC1 审计侧重于根据安全机制的描述来评估其适用性。SOC2 审计侧重于实现与可用性、安全性、完整性、隐私性和保密性相关的安全控制。
